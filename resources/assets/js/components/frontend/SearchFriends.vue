<style>
.round-image-large {
  border-radius: 50%;
  width: 150px;
  height: 150px;
  position: absolute;
  box-shadow: 0 0 23px 0px orange, 0 0 0px 0px gold;
}
#round-image-large0 {
  top: 41%;
  left: 39%;
  border-radius: 50%;
  width: 13vw;
  height: 25vh;
  position: absolute;
  box-shadow: 0 0 23px 0px orange, 0 0 0px 0px gold;
}
#round-image-large1 {
  top: 3%;
  left: 56%;
  border-radius: 50%;
  width: 13vw;
  height: 25vh;
  position: absolute;
  box-shadow: 0 0 23px 0px orange, 0 0 0px 0px gold;
}

#round-image-large2 {
  bottom: 5%;
  right: 17%;
  border-radius: 50%;
  width: 13vw;
  height: 25vh;
  position: absolute;
  box-shadow: 0 0 23px 0px orange, 0 0 0px 0px gold;
}

#round-image-large3 {
  width: 13vw;
  height: 25vh;
  top: 8%;
  left: 2%;
  border-radius: 50%;
  position: absolute;
  box-shadow: 0 0 23px 0px orange, 0 0 0px 0px gold;
}

#round-image-large4 {
  bottom: 5%;
  left: 21%;
  border-radius: 50%;
  width: 13vw;
  height: 25vh;
  position: absolute;
  box-shadow: 0 0 23px 0px orange, 0 0 0px 0px gold;
}

#round-image-large5 {
  border-radius: 50%;
  width: 11vw;
  height: 20vh;
  position: absolute;
  box-shadow: 0 0 12px 0px yellow, 0 0 0px 0px blue;
  top: 4%;
  right: 2%;
}

[id^="round-image-large"] #user-img {
  width: 100%;
  height: 100%;
  border-radius: 50%;
  border-radius: 50%;
  position: absolute;
  box-shadow: 0 0 12px 0px blue, 0 0 0px 0px red;
}
[id^="round-image-large"] a {
  border-radius: 50%;
}

.round-image-small {
  border-radius: 50%;
  width: 90px;
  height: 90px;
  position: absolute;

  border-radius: 50%;
  width: 150px;
  height: 150px;
  position: absolute;
  box-shadow: 0 0 23px 0px orange, 0 0 0px 0px gold;
}

#round-image-large6 {
  right: 2%;
  border-radius: 50%;
  width: 11vw;
  height: 20vh;
  position: absolute;
  box-shadow: 0 0 12px 0px yellow, 0 0 0px 0px blue;
  top: 38%;
}

#round-image-large7 {
  right: 32%;
  top: 50%;
  border-radius: 50%;
  width: 8vw;
  height: 15vh;
  position: absolute;
  box-shadow: 0 0 12px 0px green, 0 0 0px 0px grey;
}

#round-image-large8 {
  right: 20%;
  top: 35%;
  border-radius: 50%;
  width: 7vw;
  height: 13vh;
  position: absolute;
  box-shadow: 0 0 12px 0px orange, 0 0 0px 0px green;
}

#round-image-large9 {
  left: 3%;
  bottom: 5%;
  border-radius: 50%;
  width: 7vw;
  height: 13vh;
  position: absolute;
  box-shadow: 0 0 12px 0px orange, 0 0 0px 0px green;
}

#round-image-large10 {
  left: 23%;
  top: 1%;
  border-radius: 50%;
  width: 7vw;
  height: 13vh;
  position: absolute;
  box-shadow: 0 0 12px 0px orange, 0 0 0px 0px yellow;
}

#round-image-large11 {
  right: 2%;
  bottom: 5%;
  border-radius: 50%;
  width: 5vw;
  height: 10vh;
  position: absolute;
  box-shadow: 0 0 12px 0px orange, 0 0 0px 0px yellow;
}

#round-image-large12 {
  left: 23%;
  top: 38%;
  border-radius: 50%;
  width: 7vw;
  height: 13vh;
  position: absolute;
  box-shadow: 0 0 12px 0px orange, 0 0 0px 0px yellow;
}

#round-image-large13 {
  left: 42%;
  top: 26%;
  border-radius: 50%;
  width: 5vw;
  height: 10vh;
  position: absolute;
  box-shadow: 0 0 12px 0px green, 0 0 0px 0px yellow;
}

#round-image-large14 {
  left: 1%;
  top: 46%;
  border-radius: 50%;
  width: 4vw;
  height: 8vh;
  position: absolute;
  box-shadow: 0 0 12px 0px green, 0 0 0px 0px yellow;
}

#search-friends {
  display: inline-block;
  position: absolute;
  left: 40%;
  bottom: 3%;
}
.req-icon1 {
  width: 40px !important;
  position: relative;
  height: 40px !important;
  top: calc(50% - 10px) !important;
  border-radius: 50%;
  padding: 2px;
  color: white;
  background-color: rgb(43, 169, 199);
}
.req-icon2 {
  width: 40px !important;
  position: relative;
  height: 40px !important;
  top: calc(50% - 10px) !important;
  border-radius: 50%;
  padding: 2px;
  color: white;
  background-color: rgb(35, 208, 127);
}

.arrow-left {
  position: absolute;
  top: calc(50% - 30px);
  left: 1%;
  width: 30px;
  height: 30px;
  border-radius: 50%;
  background-color: white;
}
.arrow-right {
  position: absolute;
  top: calc(50% - 30px);
  right: 1%;
  width: 30px;
  height: 30px;
  border-radius: 50%;
  background-color: white;
}
#search-friends-view2 {
  display: flex;
  flex-direction: column;
  position: absolute;
  left: 40%;
  bottom: 3%;
}
#search-friends-view1 {
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  height: 100vh;
}
#search-friends-view1-heading {
  color: aqua;
}

.search-input {
  background-color: teal;
  color: aqua;
  border: none;
  width: 250px;
  padding: 5px;
  padding-left: 10px;
  border-radius: 5px 0 0 5px;
}

.search-button {
  background-color: transparent;
  color: aqua;
  border: none;
  border: none;
  width: 60px;
  border: 1px solid gray;
  padding: 5px;
  border-radius: 0px 5px 5px 0px;
}
::placeholder {
  /* Chrome, Firefox, Opera, Safari 10.1+ */
  color: aqua;
  opacity: 1; /* Firefox */
}
</style>

<template>
  <section class="container-fluid">
    <!-- View 2 starts from here  -->
    <div v-if="searched">
      <!-- material dialog -->
      <!-- <md-dialog :md-active.sync="showDialog">
        <md-avatar class="md-avatar-icon md-large" style="width:400px;height:400px;">
          <img
            :src="'/storage/profilepicture/'+selectedUser.photo"
            style="z-index:1;border-radius:50%"
          />

          <md-button
           @click="viewProfile()"
            style="   position: absolute;
                      right: -5%;
                      padding: 3px;
                      pointer-events: all;
                      color: blue;
                      cursor: pointer;
                      z-index: 2;
                      height:auto;
                      padding:5px"
          >
            <i class="fa fa-eye req-icon1"></i>
          </md-button>

          <md-button
           @click.prevent="sendrequest()"
            style="      position: absolute;
                        left: -3%;
                        padding: 3px;
                        pointer-events: all;
                        color: blue;
                        cursor: pointer;
                        z-index: 2;
                        height:auto;
                        padding:5px"
          >
            <i class="fa fa-plus req-icon2"></i>
          </md-button>
          <span 
          class="md-title"
          style="      position: absolute;
                        padding: 3px;
                        pointer-events: all;
                        color: white;
                        z-index: 2;
                        padding:5px;
                        font-size:28px;
                        font-weight:600"
          >
            {{selectedUser.first_name+" "+selectedUser.last_name}}
          </span>
          <span 
          class="md-title"
          style="      position: absolute;
                        padding: 3px;
                        pointer-events: all;
                        color: white;
                        z-index: 2;
                        padding:5px;"
          >
            {{selectedUser.address}}
          </span>
        </md-avatar>
      </md-dialog> -->

      <!-- end of material dialog -->

      <a
        @click="backSearched()"
        style="color:white;cursor:pointer; top:20px; left:20px; position:absolute; font-size:20px"
      >
        <i @click="searched()" class="fa fa-arrow-left"></i>
        {{" "}}Go Back
      </a>
      <!-- Next and Previous buttons -->
      <div class="arrow-left" @click="prevPage(page)" v-if="page > 1">
        <img src="front/images/arrow-left.png" />
      </div>
      <div class="arrow-right" @click="nextPage(page)" v-if="next">
        <img src="front/images/arrow-right.png" />
      </div>

      <!-- Next and Previous buttons -->

      <!-- 5 main images -->
      <div v-for="(user,index) in users">
        <div :id="'round-image-large' + index" class="ani-rolloutUse" @click="handleImgClick(user)">
          <img :src="'/storage/profilepicture/' + user.photo" :key="user.id" id="user-img" />
          <!-- <a @click.prevent="sendrequest(user.id)" href>
            <i class="fas fa-user-plus req-icon"></i>
          </a>
          <a href>
            <i class="fa fa-ban req-icon"></i>
          </a>-->
        </div>
      </div>
      <div style="display:flex" id="search-friends">
        <div id="search-friends-view2">
          <h1 id="search-friends-view1-heading" style="text-align:center">
            Search
            <br />Earthlings
          </h1>
          <div style="display:flex">
            <input
              class="search-input"
              type="text"
              placeholder="Enter Name to search"
              v-model="query"
            />
            <button class="search-button" @click.prevent="search">Search</button>
          </div>
        </div>
      </div>
    </div>
    <!-- View 2 ends from here  -->

    <!-- View 1 starts from here  -->
    <div v-if="!searched">
      <div id="search-friends-view1">
        <h1 id="search-friends-view1-heading">Search Earthlings</h1>
        <div style="display:flex">
          <input
            class="search-input"
            type="text"
            placeholder="Enter Name to search"
            v-model="query"
          />
          <button class="search-button" @click.prevent="search">Search</button>
        </div>
      </div>
    </div>
    <!-- View 2 ends here  -->
  </section>
</template>

<script>
export default {
  name: "SearchFriends",
  data: function() {
    return {
      userList: [],
      page: 1,
      query: "",
      searched: false,
      cursor: "pointer",
      next: false,
      showDialog: false,
      selectedUser: {}
    };
  },
  mounted() {
    // this.fetchList();
  },
  computed: {
    users: function() {
      return this.userList.slice(0, 15);
    }
  },
  methods: {
    handleImgClick(user) {
      this.selectedUser = user;
      this.showDialog = true;
    },
    backSearched() {
      this.searched = false;
      this.userList = [];
    },
    fetchList() {
      const API = `http://127.0.0.1:8000/api/v1/users?page=${this.page}`;
      fetch(API)
        .then(response => {
          if (response.ok) {
            return response.json();
          } else throw response.json();
        })
        .then(responseJson => {
          if (responseJson.links.last !== responseJson.links.first) {
            this.next = true;
          }
          this.userList = responseJson.data;
        })
        .catch(err => alert(err));
    },
    sendrequest() {
      // alert(user_id);
      axios
        .get("/sendrequest/" + this.selectedUser.id)
        .then(response => {
          alert(response.data);
          // this.checkfriendship(this.user_id);
        })
        .catch(error => {
          console.log(error);
        });
    },

    search() {
      this.renderComponent = false;
      const API = `http://127.0.0.1:8000/api/search/${this.query}?page=${this.page}`;
      fetch(API)
        .then(response => {
          if (response.ok) {
            return response.json();
          } else throw response.json();
        })
        .then(responseJson => {
          this.userList = [];
          this.userList = responseJson;
          this.searched = true;
          if (
            responseJson.links &&
            responseJson.links.last !== responseJson.links.first
          ) {
            this.next = true;
          }
        })
        .catch(err => alert(err));
    },

    nextPage(page) {
      const API = `http://127.0.0.1:8000/api/v1/users?page=${page + 1}`;
      fetch(API)
        .then(response => {
          if (response.ok) {
            return response.json();
          } else throw response.json();
        })
        .then(responseJson => {
          this.page = page + 1;
          if (responseJson.links.last !== responseJson.links.first) {
            this.next = true;
          }
          debugger;
          this.users = responseJson.data;
        })
        .catch(err => alert(err));
    },

    previousPage(page) {
      const API = `http://127.0.0.1:8000/api/v1/users?page=${page - 1}`;
      fetch(API)
        .then(response => {
          if (response.ok) {
            return response.json();
          } else throw response.json();
        })
        .then(responseJson => {
          this.page = this.page - 1;
          if (responseJson.links.last !== responseJson.links.first) {
            this.next = true;
          }
          this.users = responseJson.data;
        })
        .catch(err => alert(err));
    }
  }
};
</script>