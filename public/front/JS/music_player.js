var videos = [
    {id:"SBH_u-vEK30",start:2},
    {id:"vBdGUBOs_r4",start:3},
    {id:"CzANBg56hFo",start:10},
    {id:"-LCAIUamxZ0",start:4},
    {id:"fZVi07gz28w",start:2},
    {id:"23dW3H9yFSU",start:30},
    {id:"y73i8YejSCU",start:5},
    {id:"yhv2WUUOAIQ",start:0},
    {id:"je0Q-0R3Fds",start:4},
    {id:"AmXuJn8Sw5k",start:0},
    {id:"5NpPRrlMhp0",start:0},
    {id:"X9Ag3UsGxRI",start:0},
    {id:"qoLmmbpbpMs",start:24},
    {id:"sQFEG84gOqo",start:0},
    {id:"sMVFXfoaS3w",start:0},
    {id:"fpHAsb2XQOY",start:11},
    {id:"t03EUTfxY5E",start:50},
    {id:"CIxXyJSqOXc",start:0},
    {id:"b3kBDtjRtB0",start:8},
    {id:"qXr0zVt-BxY",start:0},
    {id:"HIAOG9nhrt8",start:4},
    {id:"k_UOuSklNL4",start:0},
    {id:"2nGKqH26xlg",start:71},
    {id:"cunRWXodnv8",start:36},
    {id:"CZWyqj7gAAc",start:0},
    {id:"u7K5LTbaepQ",start:2},
    {id:"IOK8Jb76ibc",start:6},
    {id:"ibmh64itn1M",start:0},
    {id:"fPeExiJIqUc",start:3},
    {id:"ZUxn6JLwdDY",start:10},
    {id:"i4nYl8sQSd8",start:2},
    {id:"kGYqXwi4QXU",start:0},
    {id:"8DQVmWbele8",start:5},
    {id:"l9d5Rj0FGU8",start:8},
    {id:"Ubg7AI81VsQ",start:0},
    {id:"2-eclUz-RYI",start:0},
    {id:"GuanbnnzXQ4",start:0},
    {id:"Gcxv7i02lXc",start:4},
    {id:"lVChCevOy-8",start:0},
    {id:"wLAXfkK-DPg",start:5},
    {id:"Hc9fDn-Z3PQ",start:0},
    {id:"zBFvHDdh7oo",start:1},
    {id:"vNJnrcrvjTk",start:4},
    {id:"eDuZWJ5Uz2I",start:0},
    {id:"zkGzQulZSEo",start:0},
    {id:"mvRQtbqLPK8",start:4},
    {id:"rJtDlvmbL20",start:2},
    {id:"IrUbFvF8Lzk",start:3},
    {id:"DzBUzjucWu4",start:5},
    {id:"YR5USHu6D6U",start:1},
    {id:"Xwu1QxP84b4",start:11},
    {id:"Jq-DGs9rfBQ",start:0},
    {id:"XPbjk6TycMc",start:0},
    {id:"nVnqwLbltfo",start:0},
    {id:"QxHkLdQy5f0",start:0},
    {id:"jJfCI3FL9WI",start:24},
    {id:"yYKOceZLV04",start:0},
    {id:"8XsKk9Aj4MU",start:0},
    {id:"DWAJEAhrhS4",start:2},
    {id:"HUx9fOZOJKs",start:2},
    {id:"qeHkIb7VRUM",start:2},
    {id:"m50_K8P194M",start:0},
    {id:"c-HqO-EojS4",start:0},
    {id:"xRqI5R6L7ow",start:7},
    {id:"b8JOi1q5ugs",start:0},
    {id:"aKJvbTEnp0I",start:0},
    {id:"iteDBk6k3N8",start:0},
    {id:"50XWHxH4tJQ",start:4},
    {id:"4wrNFDxCRzU",start:4},
    {id:"6BX33M3ypgU",start:1},
    {id:"Wm-Tlc1DGFg",start:0},
    {id:"mDEbkme11Gg",start:2},
    {id:"tzvrMKQQbeU",start:0},
    {id:"qsNEu750zok",start:0},
    {id:"9BD1y0TOk3o",start:2},
    {id:"2X4ghUUCw7s",start:0},
    {id:"iMxOluEwfVw",start:4},
    {id:"-6QU1yJE84Y",start:0},
    {id:"jTaotgdYVQE",start:1},
    {id:"JwACh3Xs-FY",start:1},
    {id:"PEH2FtIkAus",start:6},
    {id:"WnrsWPmVzfk",start:4},
    {id:"z5gAYr5YP_0",start:2},
    {id:"jtAyJHwiq9k",start:10},
    {id:"cxFX8fyWpTM",start:13},
    {id:"FvLjbGxMkr8",start:0},
    {id:"MfxXVYS_F30",start:0},
    {id:"5WhUVvKTCic",start:0},
    {id:"wqCpjFMvz-k",start:4},
    {id:"zOvsyamoEDg",start:7},
    {id:"YiiysoWTZ8o",start:0},
    {id:"ayq0R3SexTQ",start:0},
    {id:"k5dkwQY-_tk",start:0},
    {id:"JS27Mrb4a1E",start:0},
    {id:"UpPoz2gy0Cc",start:0},
    {id:"8FfEhTBrlWc",start:1},
    {id:"vo8JYCqHozI",start:26},
    {id:"WL_EM4wSbqc",start:0},
    {id:"5C6lEyuibhM",start:2},
    {id:"AIR5XPWK3Vk",start:0},
    {id:"PFCekeoSTwg",start:6},
    {id:"_CTYymbbEL4",start:4},
    {id:"igQz3505y7s",start:0},
    {id:"Pm3PyY9Hhzc",start:8},
    {id:"3P-imA4618Y",start:0},
    {id:"865NKO3x0wk",start:11},
    {id:"aV8-a6VaSGg",start:0},
    {id:"IHMrMqz3Md8",start:1},
    {id:"3MjPO5w2Gvs",start:1},
    {id:"nHZoP16QmvA",start:4},
    {id:"3pMriPstagI",start:2},
    {id:"F8YSzILKdlk",start:1},
    {id:"VYGLHJPfits",start:0},
    {id:"n3Oagvi_UHQ",start:0},
    {id:"q1Oo9cwouTE",start:8},
    {id:"iyLdoQGBchQ",start:0},
    {id:"9EeDbIJQFMY",start:0},
    {id:"VxuDI3dS2L4",start:0},
    {id:"njBrvxYxJuw",start:2},
    {id:"DD97YL3wZ-w",start:1},
    {id:"ifpyNQn8D3Q",start:0},
    {id:"GM5ZTysD0Io",start:1},
    {id:"oDbR_TiM-zs",start:1},
    {id:"RgV3iLVS0R4",start:0},
    {id:"QSwPJPZpeDs",start:1},
    {id:"HsWfny7XVNI",start:1},
    {id:"JLVnT6-QNKY",start:1},
    {id:"f16cwfdSuOQ",start:0},
    {id:"VNTXQTb_5hk",start:0},
    {id:"z4ZipKdI1sY",start:1},
    {id:"Y_iPB7qgCiM",start:3},
    {id:"4L_DQKCDgeM",start:0},
    {id:"StdCqJ9qCiU",start:0},
    {id:"TYjW67HKhl4",start:0},
    {id:"OlZc3olHtp8",start:5},
    {id:"404tSfsP3eI",start:18},
    {id:"SWsStfj33Zg",start:1},
    {id:"8TFvlvbl-30",start:2},
    {id:"MY3A-xLLJXw",start:0},
    {id:"qwDBE-87NWE",start:4},
    {id:"iZ29Dsec54A",start:0},
    {id:"pXfTtKcrUWI",start:1},
    {id:"pIaIPaDfhec",start:0},
    {id:"J-DlH5LcH2g",start:11},
    {id:"x08XOMrAQzg",start:0},
    {id:"7RujKG9hmCY",start:9},
    {id:"9jMC6vmZo2w",start:0},
    {id:"WsJIDptF-2c",start:0},
    {id:"ZRuYQ9KRJms",start:0},
    {id:"CTW0ifgY9zc",start:10},
    {id:"vO0RZJu5m24",start:2},
    {id:"Cy44ocuoWhE",start:2},
    {id:"GaFOOykGHjc",start:0},
    {id:"6CNkMBIvios",start:1},
    {id:"HVS72L8VsFk",start:1},
    {id:"uu7J_Idw_S4",start:0},
    {id:"BdS73mMycjI",start:0},
    {id:"5R8RyWOKzf8",start:0},
    {id:"tcth3ccFHh0",start:1},
    {id:"pz1BosPBGlo",start:1},
    {id:"7x0MWZX8Aeg",start:0},
    {id:"-2VRd8EtYzM",start:1},
    {id:"oIrYHNH7OfY",start:2},
    {id:"eS2QCfQE9qY",start:4},
    {id:"EseMHr6VEM0",start:7},
    {id:"YYDqWDTw65U",start:0},
    {id:"9bCyWqNTZvQ",start:15},
    {id:"KTmatjyd4KM",start:1},
    {id:"Sv2je9arNz4",start:14},
    {id:"cx1qW_iG5nA",start:1},
    {id:"3qQ0MCFttFc",start:0},
    {id:"qdrY-qhP0Oo",start:3},
    {id:"p_RNy7nlgjY",start:0},
    {id:"eq1UwbDGEGo",start:0},
    {id:"a-f5KXvHmUE",start:5},
    {id:"rZ642zSpQgc",start:6},
    {id:"WyXkgHzS458",start:0},
    {id:"n4PE6gK2odM",start:6},
    {id:"gi3MeTuA7Hw",start:0},
    {id:"T4KNVT2w0mU",start:22},
    {id:"d0v2jgCDA1g",start:2},
    {id:"6XP-f7wPM0A",start:0},
    {id:"mOiOG-Ss17Y",start:0},
    {id:"_HsBjJ58RWA",start:0},
    {id:"L9NCvSakgR8",start:1},
    {id:"QvYSckKSL5g",start:3},
    {id:"Ys8ReXj1Ygw",start:6},
    {id:"JUl5z_QUm8A",start:8},
    {id:"HyAHJEDCxxM",start:0},
    {id:"wZf41UudAbI",start:19},
    {id:"UionAcrKjsQ",start:3},
    {id:"UlWcsjVC3n8",start:7},
    {id:"PoUYeE602jM",start:4},
    {id:"O192eo9zbT4",start:15},
    {id:"23GwYVIOLqk",start:0},
    {id:"ddFj_eMPCnE",start:1.5},
    {id:"d2SNX3bfYKw",start:0},
    {id:"c41IFA3N7UE",start:0},
    {id:"9w1atvkVQnE",start:0},
    {id:"BNg7fNiBmjI",start:25},
    {id:"ddFj_eMPCnE",start:1.5},
    {id:"d2SNX3bfYKw",start:0},
    {id:"c41IFA3N7UE",start:0},
    {id:"9w1atvkVQnE",start:0},
    {id:"BNg7fNiBmjI",start:25}
];
var current_video = 0;
var current_volume = 100;
var player;
var browser = Object.keys($.browser)[0];


// next slider initialization
var $nextSlider = $('.slick-carousel-1').slick({
    infinite: true,
    vertical:true,  
    // swipe: true,
    verticalSwiping:true,
    // swipeToSlide: true,
    // draggable: true,
    slidesToShow: 4,
    slidesToScroll: 1,
    // variableWidth: true,
    arrows: false,
    // adaptiveHeight: true,
    // centerMode: true
});

// volume slider initialization
var $volumeSlider = $('.slick-carousel-2').slick({
    infinite: true,
    vertical:true,  
    // swipe: true,
    verticalSwiping:true,
    // swipeToSlide: true,
    // draggable: true,
    slidesToShow: 4,
    slidesToScroll: 1,
    // variableWidth: true,
    arrows: false,
    // adaptiveHeight: true,
    // centerMode: true
});

// next color initialization
var $nextColorSlider = $('.next-colors-slider').slick({
    infinite: true,
    vertical:true,  
    // swipe: true,
    // verticalSwiping:true,
    // swipeToSlide: true,
    // draggable: true,
    slidesToShow: 4,
    slidesToScroll: 1,
    // variableWidth: true,
    arrows: false,
    // adaptiveHeight: true,
    // centerMode: true
});

// volume color initialization
var $volumeColorSlider = $('.volume-colors-slider').slick({
    infinite: true,
    vertical:true,  
    // swipe: true,
    // verticalSwiping:true,
    // swipeToSlide: true,
    // draggable: true,
    slidesToShow: 4,
    slidesToScroll: 1,
    // variableWidth: true,
    arrows: false,
    // adaptiveHeight: true,
    // centerMode: true
});

var enable_mousewheel = true;

if(browser == 'webkit') {
    enable_mousewheel = false;
    
    $nextSlider.slick('slickSetOption', 'verticalSwiping', false);
    $volumeSlider.slick('slickSetOption', 'verticalSwiping', false);

    $('.slick-carousel-1').click(function() {
        // playMusic();
        playVideo();
        
        enable_mousewheel = true;
        $nextSlider.slick('slickSetOption', 'verticalSwiping', true);
        $volumeSlider.slick('slickSetOption', 'verticalSwiping', true);
        // $('.slick-carousel-1').slick({
        //     verticalSwiping: true
        // });
    });
}

$('.slick-carousel-1').click(function() {
    showMusicPlayer();
});

// scroll next slider to go to next and previous songs
$('.slick-carousel-1').bind('wheel', function(e){
    if(enable_mousewheel) {
        if(e.originalEvent.deltaY < 0) {
            //scroll up
            $nextSlider.slick('slickNext')
            $nextColorSlider.slick('slickNext')
            // $audio_player.play()
            playPrevSong();
        }else {
            //scroll down
            $nextSlider.slick('slickPrev')
            $nextColorSlider.slick('slickPrev')
            playNextSong();
        }
    
        //prevent page fom scrolling
        return false;
    }
});

// scroll volume slider to adjust volume
$('.slick-carousel-2').bind('wheel', function(e){
    console.log(e.originalEvent.deltaY);
    if(enable_mousewheel) {
        if(e.originalEvent.deltaY < 0) {
            //scroll up
            $volumeSlider.slick('slickNext')
            $volumeColorSlider.slick('slickNext')
            volumeUp();
            
        }else {
            //scroll down
            $volumeSlider.slick('slickPrev')
            $volumeColorSlider.slick('slickPrev')
            volumeDown();
        }
    
        //prevent page fom scrolling
        return false;
    }
});

// swipe next slider to go to next and previous songs
$('.slick-carousel-1').on('swipe', function(event, slick, direction){
    if(direction == 'up') {
        $nextColorSlider.slick('slickPrev');
        playNextSong();
        // audio.play();
    } else if(direction == 'down') {
        $nextColorSlider.slick('slickNext');
        playPrevSong();
    }
});

// swipe volume slider to adjust volume
$('.slick-carousel-2').on('swipe', function(event, slick, direction){
    console.log(direction);
    if(direction == 'up') {
        $volumeColorSlider.slick('slickPrev');
        volumeDown();
    } else if(direction == 'down') {
        $volumeColorSlider.slick('slickNext')
        volumeUp();
    }
});

// Start setup music player
// var audio = document.querySelector("audio"); 
// audio.volume = 0.5;
// initAudio($('.playlist li:first-child'));

// hide music player
$('.close-btn').click(function() {
    var section = $.urlParam('section');

    $('.music-player-div').hide();

    if(window_url.includes('?')) {
        if(section == 'blog' || section == 'career_blog') {
            $('.featured-image-div.all-blog').show();
        } else if(section == 'general_blog') {
            $('.featured-image-div.general-blog').show();
        } else if(section == 'designs_blog') {
            $('.featured-image-div.designs-blog').show();
        } else {
            $('.featured-image-div.all-blog').show();
        }
    } else {
        $('.featured-image-div.all-blog').show();
    }
});

$('#youtube-icon').click(function() {
    toggleAudio();
});

$('#fullscreen-icon').click(function() {
    playFullscreen();
});

$(document).on('keyup',function(evt) {
    if (evt.keyCode == 27) {
        exitFullscreen();
    }
});

// // play music
// $('.play-button').click(function() {
//     playMusic();
//     $(this).css('display', 'none');
//     $('.pause-button').css('display', 'block');
// });

// // pause music
// $('.pause-button').click(function() {
//     pauseMusic();
//     $(this).css('display', 'none');
//     $('.play-button').css('display', 'block');
// });

// var audio_volume;
// var src, context, analyser, gainNode;
// // mute/unmute music player
// $('.volume-progress .mute-music').toggle(
//     function() {
//         // audio_volume = audio.volume;
//         // audio.volume = 0;
//         gainNode.gain.value = -1;

//         $('.volume-progress i').removeClass('fa-volume-up');
//         $('.volume-progress i').addClass('fa-volume-mute');

//         if($('#bars').css('display') != 'none'){
//             $('#bars').addClass('hide-bars');
//         }
//         // console.log('volume:'+ audio.volume);
//         // alert('volume:'+ audio.volume);
//     },
//     function() {
//         // audio.volume = audio_volume;
//         gainNode.gain.value = 1;

//         $('.volume-progress i').removeClass('fa-volume-mute');
//         $('.volume-progress i').addClass('fa-volume-up');

//         if($('#bars').css('display') != 'none'){
//             $('#bars').removeClass('hide-bars');
//         }

//         // console.log('volume:'+ audio.volume);
//         // alert('volume:'+ audio.volume);
//     }
// );

// // initialize song
// function initAudio(element){
//     var song = element.data('src');
//     var title = element.data('songtitle');
//     var artist = element.data('artist');

//     $('#music_player').attr('src', song);
//     $('.music-player-div .music-title').text(title);
//     $('.music-player-div .music-singer').text(artist);

//     $('.playlist li').removeClass('active');
//     element.addClass('active');
// }

// // play next song after the song finished
// audio.onended = function() {
//     playNextSong();
// };

// play video
function playVideo()
{
    $('.music-player-div').css('display', 'block');
    $('.featured-image-div').hide();
    playAudio();
}

// show music player
function showMusicPlayer()
{
    $('.music-player-div').css('display', 'block');
    $('.featured-image-div').hide();
}

// // play music function
// function playMusic()
// {
//     audio.play();  
//     // $('#music_player').animate({volume: 1}, 1000);

//     if($('#bars').css('display') != 'none'){
//         $('#bars').removeClass('hide-bars');
//     }
// }

// // pause music function
// function pauseMusic()
// {
//     // audio_volume = gainNode.gain.value;
//     // $('#music_player').animate({volume: 0}, 1000, 'swing', function() {
//         // really stop the music 
//         audio.pause();   
//         // audio.volume = audio_volume;
        
//         // console.log($('#bars').css('display'));
//         if($('#bars').css('display') != 'none'){
//             $('#bars').addClass('hide-bars');
//         }
//     // });
// }

var is_first = 1;
// play next song
function playNextSong()
{
    // audio.pause();
    // $('.play-button').css('display', 'none');
    // $('.pause-button').css('display', 'block');
    // var next = $('.playlist li.active').next();
    // if (next.length == 0) {
    //     next = $('.playlist li:first-child');
    // }
    // initAudio(next);
    // // $('#music_player').prop('volume', audio_volume);
    // audio.play();
    // playVideo();
    if(is_first) {
        is_first = 0;
    } else {
        if(videos.length-1 > current_video) {
            current_video += 1;
        } else if(videos.length-1 == current_video) {
            current_video = 0;
        }
    }

    playVideo();
}

// play previous song
function playPrevSong()
{
    // audio.pause();
    // $('.play-button').css('display', 'none');
    // $('.pause-button').css('display', 'block');
    // var prev = $('.playlist li.active').prev();
    // if (prev.length == 0) {
    //     prev = $('.playlist li:first-child');
    // }
    // initAudio(prev);

    // // $('#music_player').prop('volume', audio_volume);
    // audio.play();
    // playVideo();
    if(current_video != 0) {
        current_video -= 1;
    } else {
        current_video = 0;
    }

    playVideo();
}

// higher volume
function volumeUp()
{
    var volume = current_volume;
    var maxValue = 100;
    // $('.volume-progress i').removeClass('fa-volume-mute');
    // $('.volume-progress i').addClass('fa-volume-up');


    if(volume > maxValue) {
        volume = maxValue;
    } else {
        volume += 10;
    }

    current_volume = volume;

    player.setVolume(volume);

    // $('.volume-progress .progress-bar').css('height', ((volume/maxValue)*100)+'%');
    // gainNode.gain.value = volume;
}

// lower volume
function volumeDown()
{
    var volume = current_volume;
    var minValue = 0;
    var maxValue = 100;
    
    if(volume < minValue) {
        volume = minValue;
    } else {
        volume -= 10;
    }

    current_volume = volume;

    player.setVolume(volume);

    // if(volume == -1) {
    //     $('.volume-progress i').removeClass('fa-volume-up');
    //     $('.volume-progress i').addClass('fa-volume-mute');
    // }

    // $('.volume-progress .progress-bar').css('height', ((volume/maxValue)*100)+'%');
    // gainNode.gain.value = volume;
}

// audio visualizer setup
function playAudio() {
    $('.music-player-div iframe').remove();
    console.log(current_video);
    var video = videos[current_video];
    var video_id = video.id;
    var start = video.start;
    var video_player = 'youtube-player';
    
    $('.music-player-div .video-container').append('<div id="youtube-player"></div>')
    // player.pauseVideo();
    player = new YT.Player(video_player, {
        height: '100%',
        width: '100%',
        videoId: video_id,
        playerVars: {
            autoplay: 1,
            loop: 0,
            start: start,
            enablejsapi: 1,
            rel: 0,
            origin : window.location.href,
            widget_referrer: window.location.href,
            fs: 0
            // disablekb: 1
        },
        events: {
            'onReady': onPlayerReady,
            'onStateChange': onPlayerStateChange 
        } 
    });
}

function togglePlayButton(play) {    
    document.getElementById("youtube-icon").src = play ? url+"/front/images/communicator-buttons/pause-btn.png" : url+"/front/images/communicator-buttons/play-btn.png";
}

function toggleAudio() {
    if ( player.getPlayerState() == 1 || player.getPlayerState() == 3 ) {
        player.pauseVideo(); 
        togglePlayButton(false);
    } else if ( player.getPlayerState() == 0) {
        // play next video
    } else {
        player.playVideo(); 
        togglePlayButton(true);
    }
} 

function onPlayerReady(event) {
    // player.setPlaybackQuality("small");
    // event.target.pauseVideo(); 
    event.target.setVolume(current_volume);
    event.target.playVideo();

    togglePlayButton(player.getPlayerState() !== 5);
}

function onPlayerStateChange(event) {
    if (event.data === 0) {
        // togglePlayButton(false); 
        playNextSong();
        // play next video
    }

    if(event.data === 1) {
        togglePlayButton(true);
    }
}

// detect enter or exit fullscreen mode
document.addEventListener('webkitfullscreenchange', fullscreenChange);
document.addEventListener('mozfullscreenchange', fullscreenChange);
document.addEventListener('fullscreenchange', fullscreenChange);
document.addEventListener('MSFullscreenChange', fullscreenChange);

function playFullscreen (){
    player.playVideo();//won't work on mobile
    togglePlayButton(true);
    
    // check if fullscreen mode is available
    if (document.fullscreenEnabled || 
        document.webkitFullscreenEnabled || 
        document.mozFullScreenEnabled ||
        document.msFullscreenEnabled) {
        
        // which element will be fullscreen
        var iframe = document.querySelector('#youtube-player');
        // Do fullscreen
        if (iframe.requestFullscreen) {
        iframe.requestFullscreen();
        } else if (iframe.webkitRequestFullscreen) {
        iframe.webkitRequestFullscreen();
        } else if (iframe.mozRequestFullScreen) {
        iframe.mozRequestFullScreen();
        } else if (iframe.msRequestFullscreen) {
        iframe.msRequestFullscreen();
        }
    }
    else {
        Swal.fire({
            imageUrl: '../../front/icons/alert-icon.png',
            imageWidth: 80,
            imageHeight: 80,
            imageAlt: 'Mbaye Logo',
            title: 'Oops!',
            html: 'Your browser is not supported.',
            // width: '30%',
            padding: '15px',
            background: 'rgba(8, 64, 147, 0.62)'
        });
    }
}

function fullscreenChange() {
    if (document.fullscreenEnabled ||
         document.webkitIsFullScreen || 
         document.mozFullScreen ||
         document.msFullscreenElement) {
        console.log('enter fullscreen');
    }
    else {
      console.log('exit fullscreen');
    }
}
// End setup music player