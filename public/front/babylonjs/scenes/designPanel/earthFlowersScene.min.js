let earthFlowersCamera,earthFlowersSkybox,earthFlowersScene,earthFlowers_object,worldFlowerPicked,isWorldFlowersReady,worldLoadedPercent,flowerMat,isZoomPanelActive=!0,isEarthFlowersHit=!1;function create_earth_flower_scene(){(earthFlowersScene=new BABYLON.Scene(engine)).enableSceneOffline=!0,BABYLON.Database.IDBStorageEnabled=!0,earthFlowersScene.autoClear=!1,create_earth_flower_camera();let e=new BABYLON.HemisphericLight("earthFlowersLight",new BABYLON.Vector3(0,5,10),earthFlowersScene),r=new BABYLON.HemisphericLight("earthFlowersLight2",new BABYLON.Vector3(0,-5,-10),earthFlowersScene);return e.radius=300,r.radius=300,e.intensity=1,load_earth_with_flowers_mesh(),add_mouse_listener_earthflowers(),earthFlowersScene}function create_earth_flower_camera(){(earthFlowersCamera=new BABYLON.ArcRotateCamera("EarthFlowersCamera",0,0,1e3,BABYLON.Vector3(0,0,0),earthFlowersScene)).checkCollisions=!0,earthFlowersCamera.lowerRadiusLimit=35,earthFlowersCamera.upperRadiusLimit=200,earthFlowersCamera.wheelPrecision=10,earthFlowersCamera.angularSensibilityX=2e3,earthFlowersCamera.angularSensibilityY=2e3}function load_earth_with_flowers_mesh(){Promise.all([BABYLON.SceneLoader.ImportMeshAsync(null,"front/objects/designScene/worldFlowers/model/","worldLower.babylon",earthFlowersScene,function(e){var r=0;if(e.lengthComputable)r=(100*e.loaded/e.total).toFixed();else{var o=e.loaded/1048576;r+=Math.floor(100*o)/100}r>0&&r<100&&(document.getElementById("loadingScreenPercent").innerHTML="Loading: "+r+" %")}).then(function(e){for(let r=0;r<e.meshes.length;r++)"Earth"!==e.meshes[r].name&&(e.meshes[r].isPickable=!0,e.meshes[r].actionManager=new BABYLON.ActionManager(earthFlowersScene),e.meshes[r].actionManager.registerAction(new BABYLON.ExecuteCodeAction(BABYLON.ActionManager.OnPointerOverTrigger,onOverFlower)),e.meshes[r].actionManager.registerAction(new BABYLON.ExecuteCodeAction(BABYLON.ActionManager.OnPointerOutTrigger,onOutFlower)),r===e.meshes.length-1&&(isWorldFlowersReady=!0));e.meshes[0].scaling=new BABYLON.Vector3(.2,.2,.2),e.meshes[0].setEnabled(!1),e.meshes[0].isVisible=!1,e.meshes[0].isPickable=!0,earthFlowers_object=e.meshes[0],earthFlowersCamera.viewport=new BABYLON.Viewport(.65,0,.5,1)})]).then(()=>{earthFlowers_object.rotation=new BABYLON.Vector3(0,BABYLON.Tools.ToRadians(90),0)})}function load_hd_world(){earthFlowers_object.dispose(),document.getElementById("loadingScreenPercent").style.visibility="visible",BABYLON.SceneLoader.ImportMeshAsync(null,"front/objects/designScene/worldFlowers/model/","worldHigherV2.babylon",earthFlowersScene,function(e){var r=0;if(e.lengthComputable)r=(100*e.loaded/e.total).toFixed();else{var o=e.loaded/1048576;r+=Math.floor(100*o)/100}document.getElementById("loadingScreenPercent").innerHTML="Loading: "+r+" %"}).then(function(e){for(let r=0;r<e.meshes.length;r++)"Earth"!==e.meshes[r].name&&(e.meshes[r].isPickable=!0,e.meshes[r].actionManager=new BABYLON.ActionManager(earthFlowersScene),e.meshes[r].actionManager.registerAction(new BABYLON.ExecuteCodeAction(BABYLON.ActionManager.OnPointerOverTrigger,onOverFlower)),e.meshes[r].actionManager.registerAction(new BABYLON.ExecuteCodeAction(BABYLON.ActionManager.OnPointerOutTrigger,onOutFlower)));e.meshes[0].scaling=new BABYLON.Vector3(.2,.2,.2),e.meshes[0].isPickable=!0,earthFlowers_object=e.meshes[0],document.getElementById("loadingScreenPercent").style.visibility="hidden",earthFlowersCamera.viewport=new BABYLON.Viewport(.65,0,.5,1)})}function update_flowers_map_key(){let e=new Map;for(const[r,o]of flowersMap.entries()){let t=r.toLowerCase();e.set(t,o)}flowersMap.clear(),flowersMap=new Map(e)}function add_mouse_listener_earthflowers(){var e=function(e){if(0===e.button){var r=earthFlowersScene.pick(earthFlowersScene.pointerX,earthFlowersScene.pointerY);if(r.hit&&0===e.button){var o=r.pickedMesh;if("Earth"==o.name)isEarthFlowersHit=!0,isZoomPanelActive=!1,earthFlowersCamera.attachControl(canvas,!0);else if(o===earthFlowersSkybox)earthFlowersCamera.detachControl(canvas);else{earthFlowersCamera.detachControl(canvas);let e=o.name;"125VeronicaDjalonensis"===e?e="125VernoniaDjalonensis":"156Lavander"===e?e="156Lavender":"171SyzgiumAromaticum"===e?e="171SyzygiumAromaticum":"20 Primrose"===e?e="20Primrose":"26ChileanBellFlower"===e?e="26ChileanBellflower":"37SnapDragon"===e?e="37Snapdragon":"5AlphineColumbine"===e?e="5AlpineColumbine":"66Fritilliares"===e?e="66Fritillaries":"7DayLily"===e&&(e="7Daylily"),flowerName2=e.toLowerCase();let r=[];const t=flowersMap.has(e);t&&(r=flowersMap.get(e)),t&&(isBookFlowersActive&&remove_book_of_flowers(),worldFlowerPicked=e,open_book_of_flowers(e),load_design_flower_versions(r),set_instructions_overlay(3))}}}},r=function(){isEarthFlowersHit=!1},o=function(e){};canvas.addEventListener("pointerdown",e,!1),canvas.addEventListener("pointerup",r,!1),canvas.addEventListener("pointermove",o,!1),earthFlowersScene.onDispose=function(){canvas.removeEventListener("pointerdown",e),canvas.removeEventListener("pointerup",r),canvas.removeEventListener("pointermove",o)}}var onOverFlower=e=>{"Earth"!==e.source.name&&(flowerMat=e.source.material.diffuseColor,e.source.material.diffuseColor=new BABYLON.Color3(0,1,0,.8))},onOutFlower=e=>{e.source.material.diffuseColor=flowerMat};function remove_earthFlowers_scene_objects(){earthFlowersSkybox&&earthFlowersSkybox.dispose(),earthFlowers_object.dispose(),earthFlowersScene.dispose(),earthFlowersScene=null,isDesignSceneActive=!1}