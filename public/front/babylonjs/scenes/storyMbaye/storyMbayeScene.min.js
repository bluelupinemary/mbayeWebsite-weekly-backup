let secondCamView,homeGizmo,homeGizmo2,isMbayeRotating=!1,isWorldFlowersActive=!1,isFootRotateActive=!1,isHeadRotateActive=!1,imagePath="front/images3D/storyMbayeScene/",texturePath="front/textures/storyMbaye/",videoPath="front/videos/storyMbaye/";function create_camera(){let e=new BABYLON.ArcRotateCamera("Main Camera",BABYLON.Tools.ToRadians(0),BABYLON.Tools.ToRadians(0),100,new BABYLON.Vector3(0,0,0),scene);return e.fovMode=BABYLON.Camera.FOVMODE_HORIZONTAL_FIXED,e.fov=1.4,e.upperAlphaLimit=1e3,e.lowerRadiusLimit=30,e.upperRadiusLimit=1500,e.wheelPrecision=2,e.panningSensibility=100,e.target=new BABYLON.Vector3(0,0,0),e.panningDistanceLimit=1500,e.pinchPrecision=1,e.radius=1500,e.maxZ=25e3,e.alpha=BABYLON.Tools.ToRadians(90),e.beta=BABYLON.Tools.ToRadians(90),e.detachControl(canvas),scene.activeCamera=e,e.checkCollisions=!0,e}function create_light(){let e=new BABYLON.HemisphericLight("hemiLight",new BABYLON.Vector3(-30,200,10),scene);return e.diffuse=new BABYLON.Color3(1,1,1),e.intensity=1,e.radius=500,e.specular=new BABYLON.Color3(0,0,0),e.groundColor=new BABYLON.Color3(.3,.3,.3),e}function create_skybox(){let e=BABYLON.MeshBuilder.CreateBox("skybox",{size:2e4},scene);e.position.y=100,e.position.z=1e3,e.rotation.y=BABYLON.Tools.ToRadians(-60),e.isPickable=!1,e.checkCollisions=!0,e.infiniteDistance=!0,e.renderingGroupId=0;let t=new BABYLON.StandardMaterial("skyboxmatl",scene);t.backFaceCulling=!1;return t.reflectionTexture=new BABYLON.CubeTexture.CreateFromImages(["front/skybox/px.png","front/skybox/py.png","front/skybox/pz.png","front/skybox/nx.png","front/skybox/ny.png","front/skybox/nz.png"],scene),t.reflectionTexture.coordinatesMode=BABYLON.Texture.SKYBOX_MODE,t.disableLighting=!0,t.specular=new BABYLON.Vector3(0,0,0),e.material=t,e}let isGizmoDragging=!1;function enable_gizmo(e){let t=new BABYLON.UtilityLayerRenderer(scene);homeGizmo=new BABYLON.PositionGizmo(t),homeGizmo2=new BABYLON.RotationGizmo(t),t.utilityLayerScene.autoClearDepthAndStencil=!1,homeGizmo.attachedMesh=e,homeGizmo.scaleRatio=2,homeGizmo2.attachedMesh=e}let currFlower,isPlane2Selected=!1,isLaunchEnabled=!1;function setup_collage(){let e=new BABYLON.StandardMaterial(name,scene);e.diffuseColor=BABYLON.Color3.Black(),e.diffuseTexture=new BABYLON.Texture(texturePath+"collage-1-2.png",scene),e.opacityTexture=new BABYLON.Texture(texturePath+"collage-1-2.png",scene),e.diffuseTexture.uScale=1,e.diffuseTexture.vScale=-1,e.diffuseTexture.hasAlpha=!0,e.specularColor=new BABYLON.Color3(0,0,0),e.emissiveColor=BABYLON.Color3.White(),e.backFaceCulling=!1,collage_wall.material=e,add_delay(collage_wall,3e3,5e3)}function change_collage_photo(e){collage_wall.material&&collage_wall.material.dispose();let t=stageMap.get(e).collage,a=new BABYLON.StandardMaterial(name,scene);a.diffuseColor=BABYLON.Color3.Black(),a.diffuseTexture=new BABYLON.Texture(texturePath+t,scene),a.opacityTexture=new BABYLON.Texture(texturePath+t,scene),a.diffuseTexture.uScale=1,a.diffuseTexture.vScale=-1,a.opacityTexture.uScale=1,a.opacityTexture.vScale=-1,a.diffuseTexture.hasAlpha=!0,a.specularColor=new BABYLON.Color3(0,0,0),a.emissiveColor=BABYLON.Color3.White(),a.backFaceCulling=!1,collage_wall.material=a}function init_photo(e,t,a,n){let i=BABYLON.MeshBuilder.CreatePlane(e,{width:t.w,height:t.h},scene);i.position=new BABYLON.Vector3(a.x,a.y,a.z);let o=new BABYLON.StandardMaterial(e,scene);return o.diffuseTexture=new BABYLON.Texture(imagePath+e,scene),o.diffuseTexture.hasAlpha=!0,o.diffuseTexture.uScale=-1,5===n||6===n||7===n?(i.rotation=new BABYLON.Vector3(BABYLON.Tools.ToRadians(-90),0,BABYLON.Tools.ToRadians(0)),o.opacityTexture=new BABYLON.Texture(imagePath+e,scene),o.opacityTexture.uScale=-1):25!==n&&26!==n&&29!==n&&30!==n&&36!==n&&38!==n&&40!==n&&48!==n&&49!==n&&50!==n&&53!==n&&58!==n&&61!==n&&63!==n&&67!==n&&68!==n&&69!==n&&70!==n&&71!==n&&73!==n&&74!==n&&75!==n&&76!==n||(o.opacityTexture=new BABYLON.Texture(imagePath+e,scene),o.opacityTexture.uScale=-1),o.emissiveColor=BABYLON.Color3.White(),o.backFaceCulling=!1,i.material=o,i}function init_video(e,t,a){let n,i=BABYLON.MeshBuilder.CreateDisc(e,{radius:t,tessellation:0},scene);i.position=new BABYLON.Vector3(0,0,-1e3),i.rotation=new BABYLON.Vector3(0,BABYLON.Tools.ToRadians(180),0),39!=a&&59!=a&&65!=a||(n=stageMap.get(a).video);var o=new BABYLON.StandardMaterial("mat",scene);o.emissiveColor=BABYLON.Color3.White();var r=new BABYLON.VideoTexture("video",[videoPath+n],scene,!0,!0);return 39!==a&&65!==a||(r.video.volume=.01),o.diffuseTexture=r,i.material=o,i}let collage1Map=new Map;function init_collage_photo(e,t,a,n){let i=BABYLON.MeshBuilder.CreatePlane(e,{width:n.w,height:n.h},scene);i.position=new BABYLON.Vector3(t.x,t.y,t.z),i.rotationQuaternion=new BABYLON.Quaternion(a.x,a.y,a.z,a.w);let o=new BABYLON.StandardMaterial(e,scene);return o.diffuseColor=BABYLON.Color3.Black(),o.diffuseTexture=new BABYLON.Texture("front/images3D/feetScene/gallery/"+e+".png",scene),o.diffuseTexture.uScale=-1,o.diffuseTexture.hasAlpha=!0,o.specularColor=new BABYLON.Color3(0,0,0),o.emissiveColor=BABYLON.Color3.White(),o.backFaceCulling=!1,i.material=o,i}function add_delay(e,t,a){let n=new BABYLON.FadeInOutBehavior;n.attach(e),n.fadeIn(!0),n.delay=t,n.fadeInTime=a}function remove_delay(e){delayManager&&delayManager.detach(e)}let is3dEnable=!1;function show_3D_icons(){$("#muteUnmuteIconDiv").css("display","block")}function set_3D_icon(e){$("#firstVideoOverlay").css("pointer-events","auto"),$("#enable3DImage").css("filter",""),$(".enable3DSpan").text("Enable 3D"),e?($("#enable3D").css("display","block"),is3dEnable=!1):($("#enable3D").css("display","none"),is3dEnable=!0)}function check_if_in_3d_map(){set_3D_icon(!!enable3DMap.has(currentStage))}function init_plane(e,t,a,n,i,o,r){let s=BABYLON.MeshBuilder.CreatePlane(e,{width:n,height:i},scene);s.isVisible=!1,s.isPickable=!0,s.position=new BABYLON.Vector3(o.x,o.y,o.z),s.rotationQuaternion=new BABYLON.Quaternion(r.x,r.y,r.z,r.w);let l=new BABYLON.StandardMaterial(t,scene);return l.diffuseColor=BABYLON.Color3.Black(),l.diffuseTexture=new BABYLON.Texture(a,scene),l.diffuseTexture.hasAlpha=!0,l.specularColor=new BABYLON.Color3(0,0,0),l.emissiveColor=BABYLON.Color3.White(),l.backFaceCulling=!1,s.material=l,s}function init_disc(e,t){let a=stageMap.get(e).discImg;t||(t=200);let n=BABYLON.MeshBuilder.CreateDisc("ImageDisc"+e,{radius:t,tessellation:0},scene);n.position=new BABYLON.Vector3(0,1e3,0),n.rotation=new BABYLON.Vector3(BABYLON.Tools.ToRadians(90),BABYLON.Tools.ToRadians(0),BABYLON.Tools.ToRadians(180));let i=new BABYLON.StandardMaterial("matlName",scene);return i.diffuseTexture=new BABYLON.Texture(imagePath+a,scene),i.emissiveColor=BABYLON.Color3.White(),53===e&&(i.opacityTexture=new BABYLON.Texture(imagePath+a,scene)),hl.addMesh(n,new BABYLON.Color3(0,.5,.5)),i.backFaceCulling=!1,n.material=i,n}function init_earth(){let e=BABYLON.Mesh.CreateSphere("earth",30,200,scene);e.position=new BABYLON.Vector3(0,0,0);let t=new BABYLON.StandardMaterial("earthMatl",scene);return t.diffuseTexture=new BABYLON.Texture(texturePath+"earthMap.jpg",scene),t.diffuseTexture.vScale=-1,t.diffuseTexture.uScale=-1,t.specularColor=new BABYLON.Color3(0,0,0),t.emissiveColor=BABYLON.Color3.White(),e.material=t,e}function next_stage(e){1==e&&(animateCameraTargetToPosition(storyCamera,speed,frameCount,new BABYLON.Vector3(0,100,0)),animateCameraToPosition(storyCamera,speed,frameCount,new BABYLON.Vector3(-55.43,71.79,63.59)))}$("#enable3D").on("click",function(){is3dEnable?($("#firstVideoOverlay").css("pointer-events","auto"),$("#enable3DImage").css("filter",""),$(".enable3DSpan").text("Enable 3D")):($("#firstVideoOverlay").css("pointer-events","none"),$("#enable3DImage").css("filter","drop-shadow(1px 1px 5px rgba(255, 255, 255, 0.5))"),$(".enable3DSpan").text("Disable 3D")),is3dEnable=!is3dEnable});var speed=45;let speed2=60;var frameCount=200,animateCameraTargetToPosition=function(e,t,a,n){var i=new BABYLON.CubicEase;i.setEasingMode(BABYLON.EasingFunction.EASINGMODE_EASEINOUT),BABYLON.Animation.CreateAndStartAnimation("at5",e,"target",t,a,e.target,n,0,i)},animateCameraToPosition=function(e,t,a,n){var i=new BABYLON.CubicEase;i.setEasingMode(BABYLON.EasingFunction.EASINGMODE_EASEINOUT),BABYLON.Animation.CreateAndStartAnimation("at4",e,"position",t,a,e.position,n,0,i,posAnimEnded)},animateCameraToRadius=function(e,t,a,n){var i=new BABYLON.CubicEase;i.setEasingMode(BABYLON.EasingFunction.EASINGMODE_EASEINOUT),BABYLON.Animation.CreateAndStartAnimation("at4",e,"radius",t,a,e.radius,n,0,i,radiusAnimEnded)},animateObjectScaling=function(e,t,a,n){var i=new BABYLON.CubicEase;i.setEasingMode(BABYLON.EasingFunction.EASINGMODE_EASEINOUT),BABYLON.Animation.CreateAndStartAnimation("objScale",e,"scaling",t,a,e.scaling,n,0,i)},animateObjectPosition=function(e,t,a,n){var i=new BABYLON.CubicEase;i.setEasingMode(BABYLON.EasingFunction.EASINGMODE_EASEINOUT),BABYLON.Animation.CreateAndStartAnimation("objPos",e,"position",t,a,e.position,n,0,i)},animateObjectPositionNoEase=function(e,t,a,n){(new BABYLON.CubicEase).setEasingMode(BABYLON.EasingFunction.EASINGMODE_EASEINOUT),BABYLON.Animation.CreateAndStartAnimation("objPos",e,"position",t,a,e.position,n,0,null)},animateObjectRotation=function(e,t,a,n){var i=new BABYLON.CubicEase;i.setEasingMode(BABYLON.EasingFunction.EASINGMODE_EASEINOUT),BABYLON.Animation.CreateAndStartAnimation("objPos",e,"rotation",t,a,e.rotation,n,0,i)},animateObjectRotationNoEase=function(e,t,a,n){BABYLON.Animation.CreateAndStartAnimation("objPos",e,"rotation",t,a,e.rotation,n,0,null)},animateObjectFadeOut=function(e,t,a,n){var i=new BABYLON.CubicEase;i.setEasingMode(BABYLON.EasingFunction.EASINGMODE_EASEINOUT),BABYLON.Animation.CreateAndStartAnimation("objPos",e,"visibility",t,a,e.visibility,n,0,i)},setCamDefault=function(e){storyCamera.target=new BABYLON.Vector3(0,0,0),storyCamera.radius=e||1500,storyCamera.alpha=BABYLON.Tools.ToRadians(90),storyCamera.beta=BABYLON.Tools.ToRadians(90)},setCamLateralLeft=function(){storyCamera.position=new BABYLON.Vector3(-95,0,26)},setCamLateralRight=function(){animateCameraTargetToPosition(storyCamera,speed,frameCount,new BABYLON.Vector3(-5,15,0)),animateCameraToPosition(storyCamera,speed,frameCount,new BABYLON.Vector3(85,15,0))},setCamPosterior=function(){animateCameraTargetToPosition(storyCamera,speed,frameCount,new BABYLON.Vector3(0,15,-5)),animateCameraToPosition(storyCamera,speed,frameCount,new BABYLON.Vector3(0,15,85))},setCamAnterior=function(){animateCameraTargetToPosition(storyCamera,speed,frameCount,new BABYLON.Vector3(0,15,5)),animateCameraToPosition(storyCamera,speed,frameCount,new BABYLON.Vector3(0,15,-85))},setCamSuperior=function(){storyCamera.beta=BABYLON.Tools.ToRadians(0),storyCamera.radius=130},setCamInferior=function(){storyCamera.beta=BABYLON.Tools.ToRadians(180),storyCamera.radius=130},animateCamInferior=function(){animateCameraToPosition(storyCamera,20,160,new BABYLON.Vector3(0,-20,0))};let isMbayeRotateActive=!1;var radiusAnimEnded=function(){isMbayeRotateActive&&animateObjectRotation(mbaye_obj,15,frameCount,new BABYLON.Vector3(0,BABYLON.Tools.ToRadians(255),0)),isFootRotateActive&&animateObjectRotationNoEase(rfoot_obj,10,frameCount,new BABYLON.Vector3(0,BABYLON.Tools.ToRadians(450),0)),isHeadRotateActive&&(animateObjectRotationNoEase(head_obj,20,frameCount,new BABYLON.Vector3(0,BABYLON.Tools.ToRadians(450),0)),currentStage-1==52&&highlightFlowers())},animCamEnded=function(){},posAnimEnded=function(){"top"==secondCamView&&setCamDefault(80)};function create_animation(e){"earth"===e&&(theObj=earth_obj)}let yt_player,isRotateSkybox=!0,isEarthRotating=!0;function rotate_sky(){engine.runRenderLoop(function(){isEarthRotating&&earth_obj&&earth_obj.rotate(new BABYLON.Vector3(0,4,0),-.005,BABYLON.Space.LOCAL),skybox&&isRotateSkybox&&skybox.rotate(new BABYLON.Vector3(0,4,0),.001,BABYLON.Space.LOCAL)})}function remove_stage_objects(){for(const[e,t]of currStageObjMap.entries())t.dispose();currStageObjMap.clear()}function remove_texts(){$(".firstVideoOverlayText div").each(function(){$(this).remove()})}function remove_highlighted_objects(e){e.removeAllMeshes()}async function getLastText(e){return e.forEach(function(e){$(".firstVideoOverlayText").append(e)}),e.length}async function create_texts(e){let t,a=stageMap.get(e).texts;textArrLen=await getLastText(a),t=14===e?"txt"+(textArrLen-3):"txt"+(textArrLen-2);let n=document.getElementById(t);var i=whichAnimationEvent();n.addEventListener(i,showContinueButton)}function showContinueButton(){setTimeout(function(){$("#continueBtnDiv").css("visibility","visible"),currentStage>2?$("#prevBtnDiv").css("visibility","visible"):currentStage>=76&&$("#continueBtnDiv").css("visibility","hidden"),76==currentStage&&$("#continueBtnDiv").css("visibility","hidden")},2e3)}function whichAnimationEvent(){var e={animation:"animationend",OAnimation:"oAnimationEnd",MozAnimation:"animationend",WebkitAnimation:"webkitAnimationEnd"};for(t in e)if(void 0!==lastScriptTxt.style[t])return e[t]}let isMusicChanged=!1,theClick=0;function setup_music_player(){$(".player").empty();var e=document.getElementById("player");window.YT.ready(function(){yt_player=new window.YT.Player(e,{host:"https://www.youtube.com",height:"0",width:"0",videoId:"",playerVars:{autoplay:1,loop:1,start:0,fs:0,playsinline:1,enablejsapi:1,origin:window.location.href,widget_referrer:window.location.href},events:{onReady:onPlayerReady,onStateChange:onPlayerStateChange}})})}function onPlayerReady(e){e.target.playVideo()}function load_music(e,t,a){$(".player").empty(),yt_player.loadVideoById(e,t),yt_player.playVideo(),isMusicPlaying=!0}function stop_music(){yt_player.stopVideo(),isMuted=!0,isMusicPlaying=!1}function pause_music(){yt_player.pauseVideo(),isMusicPlaying=!1,isMuted=!0}function play_music(){isMusicPlaying=!0,isMuted=!1,yt_player.playVideo(),setTimeout(function(){3===yt_player.getPlayerState()&&yt_player.playVideo()},500)}let isMusicPlaying=!1,isFirstLoad=!1;function onPlayerStateChange(e){switch(e.data){case 0:isMusicPlaying&&yt_player.playVideo()}isSoundIconClicked||isFirstLoad||1===e.data&&"Chrome"===testBrowser()&&($(".muteUnmuteIcon").remove(),$("#muteUnmuteIconDiv").append('<i class="fas fa-volume-up muteUnmuteIcon"></i>'),isMuted=!1,isMusicPlaying=!0,isFirstLoad=!0)}let lastScriptTxt=document.getElementById("txt1");var animationEvent=whichAnimationEvent();function set_scale(){return getRandomInt(4,5)}function getRandomInt(e,t){return Math.floor(Math.random()*(t-e+1)+e)}lastScriptTxt.addEventListener(animationEvent,showContinueButton);let stageFlowersMap=new Map;function load_orig_flowers(e){let t;if(2==e?t=rFootFlowersMap:3==e&&(t=flowersMbayeMap),t)for(const[a,n]of t.entries()){let t;null!==n[0]&&(t=n[0]);let i=set_scale();3==e&&(i=50);let o=init_flower(a,a+"Matl","front/images3D/flowers2D/orig/"+a+".png",i,t.x,t.y,t.z);stageFlowersMap.set(a,o)}}function init_flower(e,t,a,n,i,o,r){let s=BABYLON.Mesh.CreatePlane(e,n,scene);s.isVisible=!1,s.position=new BABYLON.Vector3(i,o,r),s.rotation.y=BABYLON.Tools.ToRadians(-90);let l=new BABYLON.StandardMaterial(t,scene);return l.diffuseColor=BABYLON.Color3.Black(),l.diffuseTexture=new BABYLON.Texture(a,scene),l.diffuseTexture.hasAlpha=!0,l.specularColor=new BABYLON.Color3(0,0,0),l.emissiveColor=BABYLON.Color3.White(),l.backFaceCulling=!1,l.freeze(),s.material=l,s}function setFlowerVisibility(e){for(const[t,a]of stageFlowersMap.entries())a.isVisible=e,a.setEnabled(e)}function removeFlowers(){for(const[e,t]of stageFlowersMap.entries())t.dispose();stageFlowersMap.clear()}function initialize_icons(){$(".muteUnmuteIcon").remove(),$("#muteUnmuteIconDiv").append('<i class="fas fa-volume-mute muteUnmuteIcon"></i>'),isMuted=!0,isMusicPlaying=!1,(isMobile()||isSmallDevice())&&($(".btn").removeClass("arrow-down"),$(".btn").removeClass("arrow-up"))}var isMuted=!1;$("#muteUnmuteIconDiv").on("click",function(e){isSoundIconClicked=!0,$(".muteUnmuteIcon").remove(),isMuted?($("#muteUnmuteIconDiv").append('<i class="fas fa-volume-up muteUnmuteIcon"></i>'),yt_player&&play_music()):($("#muteUnmuteIconDiv").append('<i class="fas fa-volume-mute muteUnmuteIcon"></i>'),yt_player&&pause_music())});