let canvas,engine,theAstroFace,headCamera,hl,flowerColor,rfoot_obj,rfoot_meshes,foot_plane,foot_heart_label,DISC_CAM_INIT_POS={x:2.83,y:.44,z:580.01},cameraInitState={position:null,a:null,b:null,r:null,upperA:null,lowerA:null,upperB:null,lowerB:null,upperR:null,lowerR:null,angularY:null},astroInitState={x:0,y:0,z:0},createContactScene=function(){canvas=document.getElementById("canvas"),(engine=new BABYLON.Engine(canvas,!0,{preserveDrawingBuffer:!0,stencil:!0})).enableOfflineSupport=!0,scene=new BABYLON.Scene(engine),BABYLON.Database.IDBStorageEnabled=!0,scene.collisionsEnabled=!0;let e=new BABYLON.CubeTexture.CreateFromPrefilteredData("front/textures/environment.dds",scene);return e.gammaSpace=!1,scene.environmentTexture=e,load_3D_mesh(),load_orig_flowers(),create_skybox(),headCamera=create_camera(),create_light(),hl=new BABYLON.HighlightLayer("hl1",scene),flowerColor=new BABYLON.HighlightLayer("flowerColor",scene),scene};function create_camera(){let e=new BABYLON.ArcRotateCamera("Main Camera",BABYLON.Tools.ToRadians(0),BABYLON.Tools.ToRadians(0),30,new BABYLON.Vector3(-60.752,10,7.05),scene);return e.fovMode=BABYLON.Camera.FOVMODE_HORIZONTAL_FIXED,e.fov=1.4,e.upperAlphaLimit=1e3,e.lowerRadiusLimit=40,e.upperRadiusLimit=200,e.wheelPrecision=3,e.panningSensibility=300,e.target=new BABYLON.Vector3(0,0,0),e.panningDistanceLimit=70,e.pinchPrecision=1,e.radius=100,e.maxZ=28e4,e.alpha=2.8985,e.beta=1.5703,e.attachControl(canvas,!0),scene.activeCamera=e,e.checkCollisions=!0,cameraInitState.position=new BABYLON.Vector3(-198.34,80.42,162.37),cameraInitState.a=e.alpha,cameraInitState.b=e.beta,cameraInitState.r=e.radius,e}function create_light(){let e=new BABYLON.HemisphericLight("hemiLight",new BABYLON.Vector3(-30,200,10),scene);e.diffuse=new BABYLON.Color3(1,1,1),e.radius=500,e.specular=new BABYLON.Color3(0,0,0),e.groundColor=new BABYLON.Color3(.3,.3,.3)}function create_skybox(){let e=BABYLON.MeshBuilder.CreateBox("contactSkybox",{size:25e3},scene);e.position=new BABYLON.Vector3(942,-500,-1500),e.rotation.y=BABYLON.Tools.ToRadians(-60),e.isPickable=!1,e.checkCollisions=!0,e.infiniteDistance=!0,e.renderingGroupId=0;let n=new BABYLON.StandardMaterial("contactSkyboxMaterial",scene);n.backFaceCulling=!1;return n.reflectionTexture=new BABYLON.CubeTexture.CreateFromImages(["front/skybox/px.png","front/skybox/py.png","front/skybox/pz.png","front/skybox/nx.png","front/skybox/ny.png","front/skybox/nz.png"],scene),n.reflectionTexture.coordinatesMode=BABYLON.Texture.SKYBOX_MODE,n.disableLighting=!0,n.specular=new BABYLON.Vector3(0,0,0),e.material=n,n.freeze(),e.freezeWorldMatrix(),e}let homeGizmo,homeGizmo2,panelFlowersMap=new Map;function load_3D_mesh(){var e=0;Promise.all([BABYLON.SceneLoader.ImportMeshAsync(null,"front/objects/headMbayeScene/","HeadMbaye0803.glb",scene,function(n){if(n.lengthComputable)e=(100*n.loaded/n.total).toFixed();else{var t=n.loaded/1048576;e+=Math.floor(100*t)/100}document.getElementById("loadingScreenPercent").innerHTML="Loading: "+e+" %"}).then(function(e){e.meshes[0].scaling=new BABYLON.Vector3(8,8,-8),e.meshes[0].rotation=new BABYLON.Vector3(0,BABYLON.Tools.ToRadians(12),0),e.meshes[0].isPickable=!0,(rfoot_obj=e.meshes[0]).checkCollisions=!0,rfoot_meshes=e.meshes,e.meshes.forEach(function(e){if("FP7"===e.name&&(e.hasVertexAlpha=!1),"no name"===e.name&&(e.name="82Gladiolus"),"23westernColumbine"===e.name&&(e.name="23WesternColumbine (5)"),e.isPickable=!0,"Head"===e.name||"FP1"===e.name||"FP2"===e.name||"FP3"===e.name||"FP4"===e.name||"FP5"===e.name||"FP6"===e.name||"FP7"===e.name||"FP8"===e.name||"FP9"===e.name||"FP10"===e.name||"FP11"===e.name||"FP12"===e.name||"FP13"===e.name||"FP14"===e.name||"FP15"===e.name||"FP16"===e.name||"FP17"===e.name||"FP18"===e.name||"FP17_primitive0"===e.name||"FP17_primitive1"===e.name||"FP8_primitive0"===e.name||"FP8_primitive1"===e.name){let n=new BABYLON.PBRMaterial("pbr",scene);e.material=n,e.material.backFaceCulling=!1,n.albedoColor=new BABYLON.Color3(.5,.5,.5),n.emissiveColor=new BABYLON.Color3(0,0,0),n.metallic=1,n.metallicF0Factor=.5,n.roughness=.15,n.microSurface=1}else if("L_EYEAventurine"===e.name||"R_EYEAventurine"===e.name)e.material.albedoColor=new BABYLON.Color3(.01,.2,.07);else if("L_EYEObsidian"===e.name||"R_EYEObsidian"===e.name||"__root__"===e.name);else if("HeadCover"===e.name)e.visibility=.7;else{let n=new BABYLON.StandardMaterial("pbr",scene);e.material.transparencyMode=0,e.visibility=0,e.material=n,panelFlowersMap.set(e.name,e)}})})]).then(()=>{add_mouse_listener(),setup_music_player()})}let isGizmoDragging=!1;function enable_gizmo(e){let n=new BABYLON.UtilityLayerRenderer(scene);homeGizmo=new BABYLON.PositionGizmo(n),homeGizmo2=new BABYLON.RotationGizmo(n),n.utilityLayerScene.autoClearDepthAndStencil=!1,homeGizmo.attachedMesh=e,homeGizmo.scaleRatio=2,homeGizmo2.attachedMesh=e,homeGizmo.onDragStartObservable.add(function(){isGizmoDragging=!0}),homeGizmo.onDragEndObservable.add(function(){isGizmoDragging=!1,homeGizmo2.attachedMesh=null,homeGizmo.attachedMesh=null})}let currFlower,tempFlower,isPlane2Selected=!1,isLaunchEnabled=!1,cameraInitPos={a:null,b:null},isPointerDown=!1;function add_mouse_listener(){var e=function(e){if(scene){var n=scene.pick(scene.pointerX,scene.pointerY);if(n.hit){let e=n.pickedMesh;if(headFlowersMap.has(e.name)){get_head_mesh(e.name);let n=flowersMbayeMap.get(e.name),t=n[3].id,o=n[3].start;e.name!=currFlower?(load_flower_music(t,o),currFlower=e.name):e.name==currFlower&&$("#musicVideoDiv").css("display","flex")}}else isPointerDown||(isPointerDown=!0)}},n=function(){isPointerDown=!1};var t=function(e){isPointerDown&&set_flower_angle()};canvas.addEventListener("pointerdown",e,!1),canvas.addEventListener("pointerup",n,!1),canvas.addEventListener("pointermove",t,!1),scene.onDispose=function(){canvas.removeEventListener("pointerdown",e),canvas.removeEventListener("pointerup",n),canvas.removeEventListener("pointermove",t)}}function set_flower_angle(){for(const[e,n]of origFlowersMap.entries())n.rotation.y+=.015}let focusTimer,litFlowersMap=new Map;function get_head_mesh(e){if(litFlowersMap.size>0){for(const[e,n]of litFlowersMap.entries())e.visibility=0,flowerColor.removeMesh(e);litFlowersMap.clear()}panelFlowersMap.forEach(function(n){(n.name==e||n.name.indexOf(e)>=0)&&(litFlowersMap.set(n,n.material),n.material.emissiveColor=new BABYLON.Color3(0,1,0),n.visibility=1,flowerColor.addMesh(n,BABYLON.Color3.Green()),flowerColor.innerGlow=!1)})}function set_camera_specs(e){if("init"===e)headCamera.position=cameraInitState.position,headCamera.alpha=cameraInitState.a,headCamera.beta=cameraInitState.b,headCamera.radius=cameraInitState.r;else{"b"==e?headCamera.position=new BABYLON.Vector3(127.24,-4.45,-11.36):"f"==e&&(headCamera.position=new BABYLON.Vector3(-60.752,10,7.05));let n=cameraAngleMap.get(e);headCamera.alpha=n[0].a,headCamera.beta=n[0].b,headCamera.radius=115}}function set_scale(){return getRandomInt(4,5)}function getRandomInt(e,n){return Math.floor(Math.random()*(n-e+1)+e)}document.onkeydown=(e=>{"o"!=e.key&&"O"!=e.key||(homeGizmo.attachedMesh=null,homeGizmo2.attachedMesh=null)});let nb=100;var TWO_PI=2*Math.PI,angle=TWO_PI/nb;let origScaling,origColor,flowerLbl,footMatl,origFlowersMap=new Map;function load_orig_flowers(){for(const[e,n]of headFlowersMap.entries()){let t;null!==n[0]&&(t=n[0]);let o=init_flower(e,e+"Matl","front/images3D/flowers2D/orig/"+e+".png",set_scale(),t.x,t.y,t.z);origFlowersMap.set(e,o)}}function init_flower(e,n,t,o,i,a,r){let l=BABYLON.Mesh.CreatePlane(e,o,scene);l.isVisible=!0,l.position=new BABYLON.Vector3(i,a,r),l.rotation.y=BABYLON.Tools.ToRadians(-250);let s=new BABYLON.StandardMaterial(n,scene);return s.diffuseColor=BABYLON.Color3.Black(),s.diffuseTexture=new BABYLON.Texture(t,scene),s.diffuseTexture.hasAlpha=!0,s.specularColor=new BABYLON.Color3(0,0,0),s.emissiveColor=BABYLON.Color3.White(),s.backFaceCulling=!1,s.freeze(),l.material=s,add_action_mgr(l),l}function init_foot_label(){let e=BABYLON.Mesh.CreatePlane("footHoverLbl",10,scene);e.isVisible=!0,e.position=new BABYLON.Vector3(0,3,-0),e.rotationQuaternion=new BABYLON.Quaternion(0,-.7324,0,-.6808);let n=new BABYLON.StandardMaterial("footHoverLblMatl",scene);n.diffuseColor=BABYLON.Color3.Black(),n.alpha=0,n.backFaceCulling=!1,e.material=n,foot_plane=e,add_action_mgr(e)}function init_foot_heart_label(){let e=BABYLON.MeshBuilder.CreatePlane("footHeartLbl",{width:14,height:12},scene);e.isVisible=!1,e.position=new BABYLON.Vector3(-2.2,.4,-21.28),e.rotationQuaternion=new BABYLON.Quaternion(0,-.82,0,-.5721);let n=new BABYLON.StandardMaterial("footHeartLbl",scene);n.diffuseTexture=new BABYLON.Texture("front/images3D/feetScene/footHeartLabel.png",scene),n.emissiveColor=new BABYLON.Color3(1,1,1),n.diffuseTexture.hasAlpha=!0,n.backFaceCulling=!1,foot_heart_label=e,e.material=n}function add_action_mgr(e){e.actionManager=new BABYLON.ActionManager(scene),e.actionManager.registerAction(new BABYLON.ExecuteCodeAction(BABYLON.ActionManager.OnPointerOverTrigger,onOverFlower)),e.actionManager.registerAction(new BABYLON.ExecuteCodeAction(BABYLON.ActionManager.OnPointerOutTrigger,onOutFlower))}function remove_action_mgr(){}var onOverFlower=e=>{origScaling=e.source.scaling,e.source.scaling=new BABYLON.Vector3(1.4*origScaling.x,1.4*origScaling.y,1.4*origScaling.z);let n=(.98*Math.random()+.01).toFixed(1),t=(.98*Math.random()+.01).toFixed(1),o=(.98*Math.random()+.01).toFixed(1);hl.addMesh(e.source,new BABYLON.Color3(n,t,o)),(flowerLbl=document.createElement("span")).setAttribute("id","flowerLbl");var i=flowerLbl.style;i.position="absolute",i.color="#00BFFF",i.fontFamily="Courgette-Regular",i.top=scene.pointerY+"px",i.left=scene.pointerX+20+"px",i.cursor="pointer",i.textShadow="2px 0px 5px black",isMobile()||isSmallDevice()?i.fontSize="1.7em":i.fontSize="2em";let a=e.meshUnderPointer.name;document.body.appendChild(flowerLbl),flowerLbl.textContent=flowerName.get(a)},onOutFlower=e=>{for(null==e.source.parent?e.source==rfoot_obj||(e.source==foot_plane?foot_heart_label.isVisible=!1:(e.source.scaling=origScaling,hl.removeMesh(e.source))):e.source.material.emissiveColor=new BABYLON.Color3(0,0,.5);document.getElementById("flowerLbl");)document.getElementById("flowerLbl").parentNode.removeChild(document.getElementById("flowerLbl"))};let footGalleryMap=new Map;function init_flower_photo(e,n,t,o){let i=BABYLON.MeshBuilder.CreatePlane(e,{width:o.w,height:o.h},scene);i.isVisible=!1,i.position=new BABYLON.Vector3(n.x,n.y,n.z),i.rotationQuaternion=new BABYLON.Quaternion(t.x,t.y,t.z,t.w);let a=new BABYLON.StandardMaterial(e,scene);return a.diffuseColor=BABYLON.Color3.Black(),a.diffuseTexture=new BABYLON.Texture("front/images3D/feetScene/gallery/"+e+".png",scene),a.diffuseTexture.uScale=-1,a.diffuseTexture.hasAlpha=!0,a.specularColor=new BABYLON.Color3(0,0,0),a.emissiveColor=BABYLON.Color3.White(),a.backFaceCulling=!1,i.material=a,footGalleryMap.set(i,null),i}let isGalleryVisible=!1;function set_gallery_visible(e){for(const[n,t]of footGalleryMap.entries())n.isVisible=!!e}var theScene=createContactScene();let yt_player;theScene.executeWhenReady(function(){document.getElementById("loadingScreenDiv").style.display="none",document.getElementById("loadingScreenPercent").style.display="none",document.getElementById("loadingScreenOverlay").style.display="block",testFullscreen();var e=new BABYLON.SceneOptimizerOptions;e.addOptimization(new BABYLON.HardwareScalingOptimization(0,1.5));new BABYLON.SceneOptimizer(theScene,e);(isMobile()||isSmallDevice())&&set_touch_icons(),engine.runRenderLoop(function(){theScene&&theScene.render()})}),window.addEventListener("resize",function(){engine.resize(),testOrientation(),testFullscreen()}),window.addEventListener("orientationchange",function(e){testOrientation()},!1),$(document).ready(function(){testOrientation()});let isMusicChanged=!1,theClick=0;function setup_music_player(){$(".player").empty();var e=document.getElementById("player");window.YT.ready(function(){yt_player=new YT.Player(e,{host:"https://www.youtube.com",height:"0",width:"0",videoId:"",playerVars:{autoplay:0,loop:0,start:0,enablejsapi:1,origin:window.location.href,widget_referrer:window.location.href},events:{onReady:onPlayerReady}})})}function onPlayerReady(e){e.target.playVideo()}function load_flower_music(e,n){$(".player").empty(),yt_player.loadVideoById(e,n),yt_player.playVideo(),$("#musicVideoDiv").css("display","flex")}function stop_flower_music(){yt_player.stopVideo()}$("#musicVideoDivHeader #close-btn").on("click",function(e){$("#musicVideoDiv").hide()});let isMusicFullscreen=!1;function resize_window(e,n){let t;"youtube"===n&&(t=$("#musicVideoDiv #player")),"full"===e?(t.css({width:"100vw",height:"95vh"}),"youtube"===n&&$("#musicVideoDiv").css({width:"100vw",height:"auto"}),$("#minimize-btn").css("padding-right","1%")):isMobile()||isSmallDevice()?(t.css({width:"30vw",height:"18vw"}),"youtube"===n&&$("#musicVideoDiv").css("width","30vw")):(t.css({width:"20vw",height:"12vw"}),"youtube"===n&&$("#musicVideoDiv").css("width","20vw"))}$("#musicVideoDivHeader #fullscreen-btn, #musicVideoDivHeader #minimize-btn").on("click",function(e){isMusicFullscreen?(resize_window("window","youtube"),$("#musicVideoDivHeader #fullscreen-btn").show(),$("#musicVideoDivHeader #minimize-btn").hide()):(resize_window("full","youtube"),$("#musicVideoDivHeader #fullscreen-btn").hide(),$("#musicVideoDivHeader #minimize-btn").show()),isMusicFullscreen=!isMusicFullscreen}),$("#loadingScreenOverlay").on("click",function(e){$(this).remove(),$("#loadingScreenDiv").remove(),document.getElementById("loadingScreenPercent").style.visibility="hidden",openFullscreen(),$("#fullscreenIcon").hide(),$("#MbayeHeadinfoIcon").show()}),$("#MbayeHeadinfoIcon").on("click",function(){$("#flowerInstruction").toggle(),$("#infoIconTextflowers").toggle(),$("#infoIconTextdownflower").toggle(),isIns2Active=!isIns2Active,$("#textCurve").toggle(),$("#textCurve2").toggle(),$("#textCurveanticlock").toggle(),$("#textCurveanticlock2").toggle(),set_circle_type()});let isIns2Active=!1;function set_circle_type(){try{isIns2Active?(circleType=new CircleType(document.getElementById("textCurve")),circleType3=new CircleType(document.getElementById("textCurve2")),circleType1=new CircleType(document.getElementById("textCurveanticlock")),circleType2=new CircleType(document.getElementById("textCurveanticlock2")),circleType.radius(150).dir(-1),circleType3.radius(150).dir(-1),circleType1.radius(200),circleType2.radius(200)):(circleType.destroy(),circleType1.destroy(),circleType2.destroy(),circleType3.destroy())}catch(e){}}